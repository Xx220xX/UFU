clear;
clc;
close all;
a1 = 1;
b1 = [-0.0128837788094529,0.00163596613473135,0.00176605128964141,0.00200426805687043,0.00229971225962909,0.00259869890332202,0.00284465527152107,0.00298858088078467,0.00298923898162999,0.00282345174404605,0.00248234212320424,0.00197888402963145,0.00134381615051116,0.000625109775050158,-0.000118617775321917,-0.000819582415103838,-0.00141375113511605,-0.00183994379169761,-0.00205481971083618,-0.00203003297946732,-0.00176363321017723,-0.00127367797020159,-0.000606404528559801,0.000178375467782401,0.000999135440076143,0.00177579581044118,0.00242148846056665,0.00286731162860161,0.00305367145200083,0.00295588318189242,0.00256421375021813,0.00191570943572131,0.00105310461226788,5.46689178837690e-05,-0.000940680355368782,-0.00191681389894916,-0.00271808476123466,-0.00327046238580720,-0.00350418464947989,-0.00339438722178633,-0.00293600754725038,-0.00216846848171929,-0.00115408268675502,8.72739568002925e-06,0.00121108036343587,0.00233154980871534,0.00325624043292464,0.00388463239417732,0.00414662972357525,0.00400252024213439,0.00345732245039924,0.00255142380152567,0.00136735541324020,1.38401393987006e-05,-0.00137658949423495,-0.00266820418145754,-0.00372665960751444,-0.00444330712801945,-0.00473428959853116,-0.00456293724009901,-0.00393188306209514,-0.00289558730439561,-0.00154399723192651,-8.82663343903677e-06,0.00156662394102975,0.00301890262065139,0.00420683993830444,0.00500784118562288,0.00531784219173174,0.00511453138712023,0.00439967443128019,0.00323459669746218,0.00172265547333923,9.85442973406850e-06,-0.00173827172130081,-0.00334672882329092,-0.00465526265640215,-0.00552653812503726,-0.00586589909646237,-0.00563128701339292,-0.00483457850058347,-0.00354560542068353,-0.00188390447837852,-7.69913015627665e-06,0.00189967778312916,0.00364994961275226,0.00506679138714300,0.00600447771667502,0.00636251514171624,0.00609741113297540,0.00522527654736597,0.00382545963416241,0.00202781417152686,6.24440347601274e-06,-0.00204293189566012,-0.00391594056769911,-0.00542702484943399,-0.00641951584513998,-0.00679269873332754,-0.00649773660747717,-0.00555870794006651,-0.00406452547870554,-0.00214860828113193,-2.39102406074868e-06,0.00216549700450033,0.00413967892641877,0.00572590296918280,0.00676272023202494,0.00714361420725452,0.00682255445759725,0.00582816392720612,0.00425212998850256,0.00224425679709014,1.57443557114251e-06,-0.00225771854464366,-0.00431011237308364,-0.00595188144100388,-0.00701880667107696,-0.00740177406987881,-0.00705920861896742,-0.00602104931273831,-0.00438583098781907,-0.00231156675084312,-1.24888256195254e-06,0.00231961720182995,0.00442113460661266,0.00609657500413803,0.00717866717862558,0.00755962951284519,0.00719881098165752,0.00613147420263264,0.00445857846956755,0.00234692156124663,1.04027889327198e-07,-0.00235050265946051,-0.00447101044789127,-0.00615670280817284,-0.00723991342573474,0.992386252668018,-0.00723991342573474,-0.00615670280817284,-0.00447101044789127,-0.00235050265946051,1.04027889327198e-07,0.00234692156124663,0.00445857846956755,0.00613147420263264,0.00719881098165752,0.00755962951284519,0.00717866717862558,0.00609657500413803,0.00442113460661266,0.00231961720182995,-1.24888256195254e-06,-0.00231156675084312,-0.00438583098781907,-0.00602104931273831,-0.00705920861896742,-0.00740177406987881,-0.00701880667107696,-0.00595188144100388,-0.00431011237308364,-0.00225771854464366,1.57443557114251e-06,0.00224425679709014,0.00425212998850256,0.00582816392720612,0.00682255445759725,0.00714361420725452,0.00676272023202494,0.00572590296918280,0.00413967892641877,0.00216549700450033,-2.39102406074868e-06,-0.00214860828113193,-0.00406452547870554,-0.00555870794006651,-0.00649773660747717,-0.00679269873332754,-0.00641951584513998,-0.00542702484943399,-0.00391594056769911,-0.00204293189566012,6.24440347601274e-06,0.00202781417152686,0.00382545963416241,0.00522527654736597,0.00609741113297540,0.00636251514171624,0.00600447771667502,0.00506679138714300,0.00364994961275226,0.00189967778312916,-7.69913015627665e-06,-0.00188390447837852,-0.00354560542068353,-0.00483457850058347,-0.00563128701339292,-0.00586589909646237,-0.00552653812503726,-0.00465526265640215,-0.00334672882329092,-0.00173827172130081,9.85442973406850e-06,0.00172265547333923,0.00323459669746218,0.00439967443128019,0.00511453138712023,0.00531784219173174,0.00500784118562288,0.00420683993830444,0.00301890262065139,0.00156662394102975,-8.82663343903677e-06,-0.00154399723192651,-0.00289558730439561,-0.00393188306209514,-0.00456293724009901,-0.00473428959853116,-0.00444330712801945,-0.00372665960751444,-0.00266820418145754,-0.00137658949423495,1.38401393987006e-05,0.00136735541324020,0.00255142380152567,0.00345732245039924,0.00400252024213439,0.00414662972357525,0.00388463239417732,0.00325624043292464,0.00233154980871534,0.00121108036343587,8.72739568002925e-06,-0.00115408268675502,-0.00216846848171929,-0.00293600754725038,-0.00339438722178633,-0.00350418464947989,-0.00327046238580720,-0.00271808476123466,-0.00191681389894916,-0.000940680355368782,5.46689178837690e-05,0.00105310461226788,0.00191570943572131,0.00256421375021813,0.00295588318189242,0.00305367145200083,0.00286731162860161,0.00242148846056665,0.00177579581044118,0.000999135440076143,0.000178375467782401,-0.000606404528559801,-0.00127367797020159,-0.00176363321017723,-0.00203003297946732,-0.00205481971083618,-0.00183994379169761,-0.00141375113511605,-0.000819582415103838,-0.000118617775321917,0.000625109775050158,0.00134381615051116,0.00197888402963145,0.00248234212320424,0.00282345174404605,0.00298923898162999,0.00298858088078467,0.00284465527152107,0.00259869890332202,0.00229971225962909,0.00200426805687043,0.00176605128964141,0.00163596613473135,-0.0128837788094529];
a2 = [1,-1.88783922706041,0.984959347909112];
b2 = [0.992479673954557,-1.88783922706041,0.992479673954557];
w = 0:0.01:pi;
%% sistema 1
H1 = H(a1,b1,w);
figure;
plot(w,abs(H1)); title('resposta em frequencia do sistema 1' ); xlabel('w(rad)'); ylabel('Amplitude (linear)');
saveas(gcf,'out/bb1.png');
%% sistema 2
figure;
H2 = H(a2,b2,w);
plot(w,abs(H2));title('resposta em frequencia do sistema 2' ); xlabel('w(rad)'); ylabel('Amplitude (linear)');
saveas(gcf,'out/bb2.png');

function f = H(a,b,w)
	%Soma b / Soma a
	num = 0;
	den = 0;
	for i=0:length(b)-1
    	num = num + b(i+1)*exp(-i*1j*w);
	end	

	for i=0:length(a)-1
    	den = den + a(i+1)*exp(-i*1j*w);
	end
	f = num ./ den;
end